<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel='stylesheet' href='/stylesheets/bootstrap.css'/>
    <link rel='stylesheet' href='/stylesheets/bootstrap-theme.css'/>
    <script src='/javascripts/jquery.js'></script>
    <script src='/javascripts/bootstrap.js'></script>
</head>
<body  class="container">
<h1><%= title %></h1>

<table class="table table-striped table-bordered">
    <thead>
    <tr>
        <th>Application</th>
        <th>DR1</th>
        <th>DR2</th>
        <th>DR3</th>
        <th>DR4</th>
        <th>DR5</th>
        <th>DR6</th>
        <th>(Colonne à cacher pour n'avoir que les boutons)</th>
    </tr>
    </thead>
    <tbody>
    <% for(var i = 0; i < version.length; i++) { %>
    <tr>
        <th><%= version[i].applicationName %></th>
        <td><%= version[i].DR1 %></td>
        <td><%= version[i].DR2 %></td>
        <td><%= version[i].DR3 %></td>
        <td><%= version[i].DR4 %></td>
        <td><%= version[i].DR5 %></td>
        <td><%= version[i].DR6 %></td>
        <td></td>
    </tr>
    <% } %>
    <tr>
        <th>Date de déploiement</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>
            <button type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"> Modifier</span>
            </button>
            <button type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"> Enregistrer</span>
            </button>
        </td>
    </tr>
    <tr>
        <th>Lot</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>
            <button type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"> Modifier</span>
            </button>
            <button type="button" class="btn btn-default" aria-label="Left Align">
                <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"> Enregistrer</span>
            </button>
        </td>
    </tr>
    </tbody>
</table>

<button type="button" class="btn btn-default" id="refreshBtn" aria-label="Left Align">
    <span class="glyphicon glyphicon-refresh" aria-hidden="true"> Rafraîchir</span>
</button>

<script>
    $('button').click(function(){
        document.getElementById("refreshBtn").disabled = true;
        $.ajax({url: "/data", success: function(result){
            for (i = 0; i < $('tbody tr').length ; i++){
                for (j = 0; j < $($($('tbody tr')[i]).children('td')).length; j++) {
                    $($($($('tbody tr')[i]).children('td'))[j]).text(result.version[i][j]);
                    console.log(result);
                }
            }
            document.getElementById("refreshBtn").disabled = false;
        }});
    });
</script>

</body>
</html>